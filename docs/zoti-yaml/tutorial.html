
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Tutorial &#8212; zoti-yaml 0.1.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Syntax Reference" href="syntax-reference.html" />
    <link rel="prev" title="ZOTI-YAML" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="tutorial">
<h1>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this heading">¶</a></h1>
<p>This tutorial goes through the main features of ZOTI-YAML, and is
supposed to complement the <a class="reference internal" href="syntax-reference.html"><span class="doc std std-doc">Syntax
Reference</span></a>. ZOTI-YAML is an extension of the <a class="reference external" href="https://yaml.org/spec/1.1/">YAML
1.1 language</a> which supports workflows
based on modules and library imports. To showcase such a workflow, we
set up a toy example in an arbitrary folder where the ZOTI-YAML CLI
tool is accessible. In this example we run the CLI tool as executable
Python module:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">ZOTI_YAML</span><span class="o">=</span><span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">zoti_yaml</span>
</pre></div>
</div>
<p>Let a “top” module (i.e., a module which imports and uses nodes from
other modules) called <code class="docutils literal notranslate"><span class="pre">main.zoml</span></code> be defined in the root folder as
follows:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">main.zoml</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="linenos"> 2</span><span class="nt">import</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="nv">mod1</span><span class="p p-Indicator">}</span>
<span class="linenos"> 4</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="nv">sub.mod</span><span class="p p-Indicator">,</span><span class="nt"> as</span><span class="p">:</span><span class="w"> </span><span class="nv">mod2</span><span class="p p-Indicator">}</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="nn">---</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="kt">!default</span>
<span class="linenos"> 9</span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span>
<span class="linenos">10</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mark</span><span class="p">:</span><span class="w"> </span><span class="kt">!with_create</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEFAULT_MARKING</span>
<span class="linenos">11</span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">root</span><span class="p">:</span>
<span class="linenos">12</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1</span>
<span class="linenos">13</span><span class="w">    </span><span class="nt">nodes</span><span class="p">:</span>
<span class="linenos">14</span><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1_n1</span>
<span class="linenos">15</span><span class="w">        </span><span class="nt">nodes</span><span class="p">:</span>
<span class="linenos">16</span><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1_n1_n1</span>
<span class="linenos">17</span><span class="w">            </span><span class="nt">data</span><span class="p">:</span>
<span class="linenos">18</span><span class="w">              </span><span class="kt">!attach</span>
<span class="linenos">19</span><span class="w">              </span><span class="nt">ref</span><span class="p">:</span><span class="w"> </span><span class="kt">!ref</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;../../../nodes[n1_n2]/extra&quot;</span><span class="p p-Indicator">}</span>
<span class="linenos">20</span><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1_n2</span>
<span class="linenos">21</span><span class="w">        </span><span class="nt">extra</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;I</span><span class="nv"> </span><span class="s">am</span><span class="nv"> </span><span class="s">referenced</span><span class="nv"> </span><span class="s">by</span><span class="nv"> </span><span class="s">n1_n1_n1!&quot;</span>
<span class="linenos">22</span><span class="w">        </span><span class="nt">data</span><span class="p">:</span>
<span class="linenos">23</span><span class="w">          </span><span class="kt">!attach</span>
<span class="linenos">24</span><span class="w">          </span><span class="nt">ref</span><span class="p">:</span><span class="w"> </span><span class="kt">!ref</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="nv">mod1</span><span class="p p-Indicator">,</span><span class="nt"> path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/root/node[n_who]/data&quot;</span><span class="p p-Indicator">}</span>
<span class="linenos">25</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="kt">!attach</span>
<span class="linenos">26</span><span class="w">    </span><span class="nt">ref</span><span class="p">:</span><span class="w"> </span><span class="kt">!ref</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="nv">mod2</span><span class="p p-Indicator">,</span><span class="nt"> path</span><span class="p">:</span><span class="w">  </span><span class="s">&quot;/root/nodes[n1]&quot;</span><span class="p p-Indicator">}</span>
<span class="linenos">27</span><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n2</span>
<span class="linenos">28</span><span class="w">    </span><span class="nt">content-extra</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;I</span><span class="nv"> </span><span class="s">will</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">ignored!&quot;</span>
<span class="linenos">29</span><span class="w">    </span>
</pre></div>
</div>
</div>
<p>This module imports two other modules: <code class="docutils literal notranslate"><span class="pre">mod1</span></code>, used with its qualified
name throughout the document (see line <code class="docutils literal notranslate"><span class="pre">24</span></code>), and <code class="docutils literal notranslate"><span class="pre">sub.mod</span></code> called
with an alias <code class="docutils literal notranslate"><span class="pre">mod2</span></code> throughout this document (see line <code class="docutils literal notranslate"><span class="pre">26</span></code>).</p>
<p>To keep this example simple we do not extend <code class="docutils literal notranslate"><span class="pre">pathvar</span></code> (see <a class="reference internal" href="syntax-reference.html"><span class="doc std std-doc">Syntax
Reference</span></a>), hence <code class="docutils literal notranslate"><span class="pre">mod1</span></code> needs to be defined in the
same root as the top module:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">mod1.zoml</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mod1</span>
<span class="linenos">2</span><span class="nt">sup</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ss</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="nn">---</span>
<span class="linenos">5</span>
<span class="linenos">6</span><span class="nt">root</span><span class="p">:</span>
<span class="linenos">7</span><span class="w">  </span><span class="nt">node</span><span class="p">:</span>
<span class="linenos">8</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n_who</span>
<span class="linenos">9</span><span class="w">      </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello World!</span>
</pre></div>
</div>
</div>
<p>whereas <code class="docutils literal notranslate"><span class="pre">sub.mod</span></code> is defined at the coresponding path:</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">sub/mod.zoml</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sub.mod</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="nn">---</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="nt">root</span><span class="p">:</span>
<span class="linenos"> 6</span><span class="w">  </span><span class="nt">nodes</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1</span>
<span class="linenos"> 8</span><span class="w">      </span><span class="nt">content1</span><span class="p">:</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="nv">test.txt</span><span class="p p-Indicator">}</span>
<span class="linenos"> 9</span><span class="w">      </span><span class="nt">content2</span><span class="p">:</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="nv">test.txt</span><span class="p p-Indicator">,</span><span class="nt"> begin</span><span class="p">:</span><span class="w"> </span><span class="nv">3</span><span class="p p-Indicator">,</span><span class="nt"> end</span><span class="p">:</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">}</span>
<span class="linenos">10</span><span class="w">      </span><span class="nt">content3</span><span class="p">:</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="nv">test.txt</span><span class="p p-Indicator">,</span><span class="nt"> name</span><span class="p">:</span><span class="w"> </span><span class="nv">block1</span><span class="p p-Indicator">}</span>
<span class="linenos">11</span><span class="w">      </span><span class="nt">content4</span><span class="p">:</span><span class="w"> </span><span class="kt">!include</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">file</span><span class="p">:</span><span class="w"> </span><span class="nv">test.txt</span><span class="p p-Indicator">,</span><span class="nt"> begin</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;:(!)&quot;</span><span class="p p-Indicator">,</span><span class="nt"> end</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(!):&quot;</span><span class="p p-Indicator">}</span>
<span class="linenos">12</span><span class="w">      </span><span class="nt">floating-ref</span><span class="p">:</span><span class="w"> </span><span class="kt">!ref</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;../../nodes[n1]&quot;</span><span class="p p-Indicator">}</span>
</pre></div>
</div>
</div>
<p>As seen above, module <code class="docutils literal notranslate"><span class="pre">sub.mod</span></code> references a text file in the same
relative path called <code class="docutils literal notranslate"><span class="pre">test.txt</span></code> and includes raw text from it under
its <code class="docutils literal notranslate"><span class="pre">contentX</span></code> entries, using different directives. This file contains
the following text:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">sub/test.txt</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>BEGIN block1
I am the &#39;block1&#39;.
Fear me!
END block1

:(!)
I am a monkey! Ook!
(!):
</pre></div>
</div>
</div>
<p>Finally, let us define a configuration file in the root of the project
so that we do not need to manually pass the respective CLI arguments:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">zoticonf.toml</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[zoti.yaml.toy]</span>
<span class="n">tool</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;toy-example-0.1.0&quot;</span><span class="w">  </span><span class="c1"># for bookkeeping in node metadata</span>
<span class="n">keys</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;root&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;nodes&quot;</span><span class="p">]</span><span class="w">    </span><span class="c1"># adds metadata to children of these nodes</span>
<span class="n">ext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;.zoml&quot;</span><span class="p">]</span><span class="w">             </span><span class="c1"># checks only files with extension .zoml</span>
<span class="n">pathvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;.&quot;</span><span class="p">]</span><span class="w">             </span><span class="c1"># (not required) does not look for</span>
<span class="w">			    </span><span class="c1"># libraries outside the current path</span>
</pre></div>
</div>
</div>
<p>To process the source files above, we run the command the command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ZOTI_YAML --verbose --spec=toy --out=toy.yaml main
</pre></div>
</div>
<p>The argument <code class="docutils literal notranslate"><span class="pre">--verbose</span></code> can be used to print out extensive debug
information to <code class="docutils literal notranslate"><span class="pre">stderr</span></code> and can be used to trace every step in the
processing of the source file. It can be ignored for silent
output. Since we declared <code class="docutils literal notranslate"><span class="pre">main</span></code> to be the top module then the output
file <code class="docutils literal notranslate"><span class="pre">toy.yaml</span></code> will contain the following info:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">toy.yaml</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="nn">---</span>
<span class="linenos"> 2</span><span class="nt">import</span><span class="p">:</span>
<span class="linenos"> 3</span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="nv">mod1</span><span class="p p-Indicator">}</span>
<span class="linenos"> 4</span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">as</span><span class="p">:</span><span class="w"> </span><span class="nv">mod2</span><span class="p p-Indicator">,</span><span class="nt"> module</span><span class="p">:</span><span class="w"> </span><span class="nv">sub.mod</span><span class="p p-Indicator">}</span>
<span class="linenos"> 5</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main</span>
<span class="linenos"> 6</span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">main.zoml</span>
<span class="linenos"> 7</span><span class="nt">tool-log</span><span class="p">:</span>
<span class="linenos"> 8</span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&#39;2023-01-30</span><span class="nv"> </span><span class="s">10:48:51.798700&#39;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">toy-example-0.1.0</span><span class="p p-Indicator">]</span>
<span class="linenos"> 9</span><span class="nn">---</span>
<span class="linenos">10</span><span class="nt">root</span><span class="p">:</span>
<span class="linenos">11</span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_info</span><span class="p">:</span>
<span class="linenos">12</span><span class="w">    </span><span class="nt">_pos</span><span class="p">:</span>
<span class="linenos">13</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">11</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">148</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">499</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main.zoml</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">toy-example-0.1.0</span><span class="p p-Indicator">]</span>
<span class="linenos">14</span><span class="w">  </span><span class="nt">mark</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEFAULT_MARKING</span>
<span class="linenos">15</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1</span>
<span class="linenos">16</span><span class="w">  </span><span class="nt">nodes</span><span class="p">:</span>
<span class="linenos">17</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_info</span><span class="p">:</span>
<span class="linenos">18</span><span class="w">      </span><span class="nt">_pos</span><span class="p">:</span>
<span class="linenos">19</span><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">13</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">176</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">338</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main.zoml</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">toy-example-0.1.0</span><span class="p p-Indicator">]</span>
<span class="linenos">20</span><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1_n1</span>
<span class="linenos">21</span><span class="w">    </span><span class="nt">nodes</span><span class="p">:</span>
<span class="linenos">22</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_info</span><span class="p">:</span>
<span class="linenos">23</span><span class="w">        </span><span class="nt">_pos</span><span class="p">:</span>
<span class="linenos">24</span><span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">15</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">12</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">215</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">338</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main.zoml</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">toy-example-0.1.0</span><span class="p p-Indicator">]</span>
<span class="linenos">25</span><span class="w">      </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">I am referenced by n1_n1_n1!</span>
<span class="linenos">26</span><span class="w">      </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1_n1_n1</span>
<span class="linenos">27</span><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_info</span><span class="p">:</span>
<span class="linenos">28</span><span class="w">      </span><span class="nt">_pos</span><span class="p">:</span>
<span class="linenos">29</span><span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">19</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">8</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">340</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">499</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main.zoml</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">toy-example-0.1.0</span><span class="p p-Indicator">]</span>
<span class="linenos">30</span><span class="w">    </span><span class="nt">data</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Hello World!</span>
<span class="linenos">31</span><span class="w">    </span><span class="nt">extra</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">I am referenced by n1_n1_n1!</span>
<span class="linenos">32</span><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n1_n2</span>
<span class="linenos">33</span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">_info</span><span class="p">:</span>
<span class="linenos">34</span><span class="w">    </span><span class="nt">_pos</span><span class="p">:</span>
<span class="linenos">35</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">6</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">6</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">43</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">331</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">sub/mod.zoml</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">toy-example-0.1.0</span><span class="p p-Indicator">]</span>
<span class="linenos">36</span><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">24</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">4</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">501</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">622</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">main.zoml</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&#39;toy-example-0.1.0:!attach&#39;</span><span class="p p-Indicator">]</span>
<span class="linenos">37</span><span class="w">    </span><span class="nt">_prev_attrs</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="nv">n1</span><span class="p p-Indicator">}</span>
<span class="linenos">38</span><span class="w">  </span><span class="nt">content1</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="linenos">39</span><span class="w">    </span><span class="no">BEGIN block1</span>
<span class="linenos">40</span><span class="w">    </span><span class="no">I am the &#39;block1&#39;.</span>
<span class="linenos">41</span><span class="w">    </span><span class="no">Fear me!</span>
<span class="linenos">42</span><span class="w">    </span><span class="no">END block1</span>
<span class="linenos">43</span>
<span class="linenos">44</span><span class="w">    </span><span class="no">:(!)</span>
<span class="linenos">45</span><span class="w">    </span><span class="no">I am a monkey! Ook!</span>
<span class="linenos">46</span><span class="w">    </span><span class="no">(!):</span>
<span class="linenos">47</span><span class="w">  </span><span class="nt">content2</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="linenos">48</span><span class="w">    </span><span class="no">Fear me!</span>
<span class="linenos">49</span><span class="w">    </span><span class="no">END block1</span>
<span class="linenos">50</span>
<span class="linenos">51</span><span class="w">    </span><span class="no">:(!)</span>
<span class="linenos">52</span><span class="w">  </span><span class="nt">content3</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="linenos">53</span><span class="w">    </span><span class="no">I am the &#39;block1&#39;.</span>
<span class="linenos">54</span><span class="w">    </span><span class="no">Fear me!</span>
<span class="linenos">55</span><span class="w">  </span><span class="nt">content4</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="linenos">56</span><span class="w">    </span><span class="no">I am a monkey! Ook!</span>
<span class="linenos">57</span><span class="w">  </span><span class="nt">floating-ref</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="nv">main</span><span class="p p-Indicator">,</span><span class="nt"> path</span><span class="p">:</span><span class="w"> </span><span class="s">&#39;/nodes[n1]&#39;</span><span class="p p-Indicator">}</span>
<span class="linenos">58</span><span class="w">  </span><span class="nt">mark</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DEFAULT_MARKING</span>
<span class="linenos">59</span><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">n2</span>
</pre></div>
</div>
</div>
<p>The new preamble has additional information such as the original file
path and a log. Also, notice that every child of <code class="docutils literal notranslate"><span class="pre">root</span></code> and <code class="docutils literal notranslate"><span class="pre">nodes</span></code>
contains an <code class="docutils literal notranslate"><span class="pre">_info</span></code> entry with positional metadata.</p>
<p>The effects of <code class="docutils literal notranslate"><span class="pre">!default</span></code> (in <code class="docutils literal notranslate"><span class="pre">main.zoml</span></code> line <code class="docutils literal notranslate"><span class="pre">8</span></code>) can be seen in the
fact that each 1st level child node (corresponding to the first
argument specification) contains a <code class="docutils literal notranslate"><span class="pre">mark:</span> <span class="pre">DEFAULT_MARKING</span></code>
entry. Although not existing in the original tree, this entry has been
forcefully created because of the directive <code class="docutils literal notranslate"><span class="pre">!with_create</span></code> (see
<a class="reference internal" href="syntax-reference.html"><span class="doc std std-doc">Syntax Reference</span></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">!ref</span></code> command has been resolved each time pointing to a valid
node in the module trees, enabling the <code class="docutils literal notranslate"><span class="pre">!attach</span></code> command to act
accordingly. <code class="docutils literal notranslate"><span class="pre">!attach</span></code> is used in three places, from last to first:</p>
<ul class="simple">
<li><p>in <code class="docutils literal notranslate"><span class="pre">main.zoml</span></code> line <code class="docutils literal notranslate"><span class="pre">25</span></code>: attaches the contents of the <code class="docutils literal notranslate"><span class="pre">n1</span></code> node
from <code class="docutils literal notranslate"><span class="pre">sub.mod</span></code> under the node <code class="docutils literal notranslate"><span class="pre">n2</span></code> in <code class="docutils literal notranslate"><span class="pre">main</span></code>. The behavior of the
<code class="docutils literal notranslate"><span class="pre">!include</span></code> command in <code class="docutils literal notranslate"><span class="pre">sub/mod.zoml</span></code> lines <code class="docutils literal notranslate"><span class="pre">8-11</span></code> can be seen in the
result. Notice that <code class="docutils literal notranslate"><span class="pre">floating-ref</span></code> is resolved according to its new
location (module resolved to <code class="docutils literal notranslate"><span class="pre">main</span></code> instead of <code class="docutils literal notranslate"><span class="pre">sub.mod</span></code>). Also
notice that its metadata contains its entire history and previous
attributes.</p></li>
<li><p>in <code class="docutils literal notranslate"><span class="pre">main.zoml</span></code> line <code class="docutils literal notranslate"><span class="pre">23</span></code>: attaches the <code class="docutils literal notranslate"><span class="pre">data</span></code> entry of node <code class="docutils literal notranslate"><span class="pre">n_who</span></code>
from <code class="docutils literal notranslate"><span class="pre">mod1</span></code> to the <code class="docutils literal notranslate"><span class="pre">data</span></code> entry of <code class="docutils literal notranslate"><span class="pre">n1_n2</span></code> from <code class="docutils literal notranslate"><span class="pre">main</span></code>. This is seen
in <code class="docutils literal notranslate"><span class="pre">toy.yaml</span></code> at line <code class="docutils literal notranslate"><span class="pre">30</span></code>. Since the attached node is of type
string, it does not contain any metadata.</p></li>
<li><p>in <code class="docutils literal notranslate"><span class="pre">main.zoml</span></code> line <code class="docutils literal notranslate"><span class="pre">19</span></code>: attaches the <code class="docutils literal notranslate"><span class="pre">extra</span></code> entry of the sibling
node <code class="docutils literal notranslate"><span class="pre">n1_n2</span></code> from <code class="docutils literal notranslate"><span class="pre">main</span></code> (implicit) to the <code class="docutils literal notranslate"><span class="pre">data</span></code> entry of node
<code class="docutils literal notranslate"><span class="pre">n1_n1_n1</span></code> in the same module. This is seen in <code class="docutils literal notranslate"><span class="pre">toy.yaml</span></code> at line
<code class="docutils literal notranslate"><span class="pre">25</span></code>.</p></li>
</ul>
<p>By now, you should have a rough idea of the capabilities of
ZOTI-YAML. While the new commands and their usage might seem like a
mouthful at first, their purpose is simple: to define a generic way of
working with specification trees distributed across multiple files and
libraries (possibly associated with different licenses), and construct
the information into one cohesive JSON tree. In turn, this should
enable any tool downstream to focus on parsing the right information
and construct its core objects irrespective to where information
originated, while also bookkeeping metadata for debugging purposes. As
further shown in the <span class="xref myst">complete ZOTI tutorial</span>, these
capabilities can be used to (minimally) emulate a component framework
where parameters and interfaces can be specified after loading core
components from designated libraries.</p>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">zoti-yaml</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax-reference.html">Syntax Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Links</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Ericsson/zoti/tree/main/zoti-yaml">GitHub</a></li>
<li class="toctree-l1"><a class="reference external" href="https://ericsson.github.io/zoti/">ZOTI</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">ZOTI-YAML</a></li>
      <li>Next: <a href="syntax-reference.html" title="next chapter">Syntax Reference</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Ericsson S&T.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/tutorial.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>